# tinkoff-invest-backend

Это бекенд для двух клиентов — телеграм бота и сайта

- [Список команд бота](#Список-команд-для-бота)
- [Функции сайта](#Функции-сайта)
- [Переменные окружения](#Бекенду-нужно-передать-четыре-переменные-окружения)
- [Сборка образа](#Команда-для-сборки-бекенда-в-докер-образ)
- [Запуск контейнера](#Команда-для-запуска-контейнера-с-бекендом)

### Список команд для бота

```
/get_balance - Узнать баланс (доход за всё время)
/get_portfolio - Ожидаемый доход по каждой бумаге в портфеле
/get_orders - Список активных заявок
/get_usd - Последняя цена доллара
/get_eur - Последняя цена евро
/get_stock_price - Последняя цена бумаги по тикеру. Пример - /get_stock_price AAPL
/cancel_order - Отменить заявку. Пример - /cancel_order 25446301566. Номер заявки можно взять из /get_orders
/place_limit_order - Разместить лимитную заявку. Порядок параметров важен. Пример - /place_limit_order ozon 1 sell 4200
/place_market_order - Разместить рыночную заявку. Порядок параметров важен. Пример - /place_market_order ozon 1 sell
/get_help - Вывести список всех команд
```

### Функции сайта

- Продажа и покупка бумаг
- Отображение портфеля
- Список лимитных заявок
- Стакан заявок
- Избранное

### Бекенду нужно передать три переменные окружения

```
BOT_TOKEN - токен телеграм бота
OWNER_ID - id владельца бота в телеграме. В телеграме все боты публичные. То есть обращаться к ним может кто угодно. Поэтому нужно указывать id владельца, чтобы управлять ботом мог только владелец бота
secretToken - токен Тинькофф Инвестиций
```

Если запускать сразу и бекенд и фронтенд через docker-compose, то можно положить рядом с docker-compose.yml файлик .env и записать переменные в этот файл

### Команда для сборки бекенда в докер образ

```
docker build -t termitkin/tinkoff-invest-backend:latest .
```

### Команда для запуска контейнера с бекендом

```
docker run -d -p 3025:3025 -p 3026:3026 --restart unless-stopped --name tinkoff-invest-backend -e secretToken=TINKOFF_SECRET_TOKEN -e BOT_TOKEN=TELEGRAM_BOT_TOKEN -e OWNER_ID=TELEGRAM_OWNER_ID termitkin/tinkoff-invest-backend:latest
```
